<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="com.spring.helper.dao.MemberDAO">

	<!-- 대호 시작 ======================================================================== -->
	<select id="memberConfirmidForm" resultType="int" parameterType="String">
		SELECT COUNT(*)
		  FROM USERS
		 WHERE MEMBEREMAIL = #{email}
	</select>
	
	<insert id="memberInputPro" parameterType="java.util.Map">
		INSERT INTO USERS (MEMBERNUMBER, MEMBEREMAIL, MEMBERID, 
						PASSWORD, MEMBERCOUNTRY, MEMBERREGDATE, 
						MEMBERPOINT, MEMBERRECOMMEND, AUTHORITY, 
						ENABLED, EmailConfirm, EmailKey)
		VALUES (USERSSEQ.nextVal, #{memberEmail}, #{memberId}, #{password}, 
				#{memberCountry}, sysdate, 0, 0, 'ROLE_GUEST', 
				1, 0, #{emailKey})
	</insert>
	
	<update id="memberEmailConfirmed" parameterType="String">
		UPDATE users
		   SET emailConfirm = 1, authority = 'ROLE_USER'
		 WHERE emailKey = #{emailKey}
	</update>
	
	<update id="memberModifyPro" parameterType="java.util.Map">
		UPDATE users
		   SET password = #{password},
		       memberCountry = #{memberCountry}
		 WHERE memberEmail = #{memberEmail}
	</update>
	
	<select id="memberDeleteForm" parameterType="java.util.Map" resultType="int">
		SELECT COUNT(*)
		  FROM users
		 WHERE memberEmail = #{memberEmail}
		   AND password = #{password}
	</select>
	
	<update id="memberDeletePro" parameterType="java.util.Map">
		UPDATE users
		   SET enabled = 0, AUTHORITY = 'ROLE_GUEST'
		 WHERE memberEmail = #{memberEmail}
	</update>
	
	<select id="hostMemberList" resultType="com.spring.helper.vo.BoardVO.UserVO">
		SELECT memberNumber, memberEmail, memberId, memberCountry, memberRegdate, memberPoint, authority
		  FROM users
		 ORDER BY memberNumber DESC
	</select>
	
	<select id="getCnt" resultType="int">
		SELECT COUNT(*)
		  FROM users
	</select>
	
	<!-- 대호 끝 ========================================================================= -->

</mapper>